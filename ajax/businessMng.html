<div class="row">
	<div id="breadcrumb" class="col-xs-12">
		<ol class="breadcrumb pull-left">
			<li><a class="ajax-link" href="./ajax/dashboard.html">首页</a></li>
			<li><a href="#">大数据分析</a></li>
			<li><a href="#">业务设置</a></li>
		</ol>
	</div>
	<!-- /#breadcrumb -->
</div>
<!-- /.row -->

<div class="mb-half row">
	<div class="col-xs-12" id="businessActions">
		<!-- test 添加的onclik -->
		<a href="#" class="btn btn-default" onclick="addBusiness()"><span class="glyphicon glyphicon-plus"></span> 添加</a>
		<a href="#" class="btn btn-default rely-on-table" data-func="fillBusiness('{1}')" disabled><span class="glyphicon glyphicon-edit"></span> 编辑</a>
		<a href="#" class="btn btn-default rely-on-table" data-func="delBusiness('{1}')" disabled><span class="glyphicon glyphicon-trash"></span> 删除</a>
	</div>
</div>

<div class="row">
	<div class="col-xs-12 col-md-6">
		<div class="box no-drop">
			<div class="box-header">
				<div class="box-name">
					<span>业务列表</span>
				</div>
				<div class="box-icons">
					<a class="collapse-link">
						<i class="fa fa-chevron-up"></i>
					</a>
				</div>
				<div class="no-move"></div>
			</div>
			<div class="box-content clearfix">
				<table id="businessTable" class="table tr-click table-condensed table-striped  table-block table-hover byoneTable">
					<thead>
						<tr>
							<th>名称</th>
							<th>设备数目</th>
							<th>描述</th>
						</tr>
					</thead>
					<tbody>
						<tr class="template">
							<td data-name="name"></td>
							<td data-name="count"></td>
							<td data-name="description"></td>
						</tr>
					</tbody>
				</table>

			</div>
			<!-- /.box-content -->
		</div>
		<!-- /.box -->
	</div>
	<!-- /.col-xs-12 col-md-6 -->

	<div class="col-xs-12 col-md-6">
		<div class="box no-drop">
			<div class="box-header">
				<div class="box-name">
					<span>设备列表</span>
				</div>
				<div class="box-icons">
					<a class="collapse-link">
						<i class="fa fa-chevron-up"></i>
					</a>
				</div>
				<div class="no-move"></div>
			</div>
			<div class="box-content clearfix">
				<table id="deviceTable" class="table tr-click table-condensed table-striped  table-block table-hover byoneTable">
					<thead>
						<tr>
							<th>设备名称</th>
							<th>连接IP</th>
							<th>详情</th>
						</tr>
					</thead>
					<tbody>
						<tr class="template">
							<td data-name="deviceName"></td>
							<td data-name="deviceIP"></td>
							<td data-name="description"></td>
						</tr>
					</tbody>
				</table>

			</div>
			<!-- /.box-content -->
		</div>
		<!-- /.box -->
	</div>
	<!-- /.col-xs-12 col-md-6 -->

	

</div>
<!-- /.row -->


<script type="text/javascript">
	function tableWorks() {
		setUpListTable('#deviceTable', 'queryDeviceToRole.do', {
			dataId: 'deviceIP'
		});
deviceTable
		tableTrClick('#clusterTable', function(id) {
			$('#deviceTable').byoneTable({
				ajax: "queryEsxs.do",
				"sort": ["deviceName", 'asc'],
				dataId: "id",
				filter: {
					'clusterId': id
				},
				"searchHandle": "#deviceSearch",
				"columns": [{
					"class": "deviceIp",
					"data": "deviceIp"
				}, {
					"class": "deviceName",
					"data": "deviceName"
				}, {
					"class": "deviceType",
					"data": "deviceType"
				}, {
					"class": "orgName",
					"data": "orgName"
				}, {
					"class": "hwLinkStatus",
					"data": "hwLinkStatus",
					"sortable": false
				}, {
					"class": "openStatus",
					"data": "openStatus",
					"sortable": false
				}, {
					"class": "vmCount",
					"data": "vmCount",
					"sortable": false
				}, {
					"class": "openVmCount",
					"data": "openVmCount",
					"sortable": false
				}, {
					"class": "performanceStatus",
					"data": "performanceStatus",
					"sortable": false
				}]
			});

		});

	}

	function deviceWorks()
	window.$ && $(function() {
		tableWorks();
		$('#moduleType').change(function(event) {
			mdhSelector('#genTime', $(this).val());
		}).change();
		deviceWorks({

		});
	});

</script>
<script>
	/*添加IP列表功能*/
	var __$target;
	$('.fetch').click(function(event) {
		/* Act on the event */
		__$target = $(this).siblings(':text');
		var _valList = __$target.val().split(','),
		$seledUl = $('#seledDevList').children('li').remove().end();
		for (var i = 0; i < _valList.length; i++) {
			$('<li><a href="#">' + _valList[i] + '</a></li>').appendTo($seledUl);
		};
		$('#rmDeviceAction, #addDeviceAction a').attr('disabled', 'disabled');
		$('#deviceSelModal').modal('show');
	});

	$('#seledDevList').delegate('a', 'click', function(event) {
		event.preventDefault();
		$('#addDeviceAction a').attr('disabled', 'disabled');
		$('#seledDevList a').removeClass('active');
		$(this).addClass('active');
		$('#rmDeviceAction').removeAttr('disabled').data('listItem', $(this));
	});
	window.addToList = function(ip) {
		$('<li><a href="#">' + ip + '</a></li>').appendTo($('#seledDevList'));
	}
	$('#rmDeviceAction').click(function(event) {
		/* Act on the event */
		$(this).data('listItem').remove();
		$(this).attr('disabled', 'disabled');
	});
	/*设备列表*/
	setUpListTable('#deviceTable', 'queryDeviceToRole.do', {
		dataId: 'deviceIP'
	});
	tableTrClick('#deviceTable', function() {
		$('#rmDeviceAction').attr('disabled', 'disabled');
		$('#addDeviceAction a').removeAttr('disabled');
	});
	/*提交列表*/
	$('#commitIpListBtn').click(function(event) {
		var _result = __$target.val();
		$('#seledDevList li>a').each(function(index, el) {
			_result += (_result ? ',' : '') + $(this).text();
		});
		__$target.val(_result);
		$('#deviceSelModal').modal('hide');
	});
</script>