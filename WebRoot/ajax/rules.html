<div class="row">
	<div id="breadcrumb" class="col-xs-12">
		<a href="#" class="show-sidebar">
			<i class="fa fa-bars"></i>
		</a>
		<ol class="breadcrumb pull-left">
			<li><a class="ajax-link" href="./ajax/dashboard.html">首页</a></li>
			<li><a href="#">知识库</a></li>
			<li><a href="#">规则</a></li>
		</ol>
	</div>
	<!-- /#breadcrumb -->
</div>
<!-- /.row -->
<div class="row">
	<div class="col-xs-12">
		<div class="box">
			<div class="box-header">
				<div class="box-name">
					<span>资产信息</span>
				</div>
				<div class="box-icons">
					<a class="collapse-link">
						<i class="fa fa-chevron-up"></i>
					</a>
				<!-- <a class="expand-link">
					<i class="fa fa-expand"></i>
				</a> -->
				<a class="close-link">
					<i class="fa fa-times"></i>
				</a>
			</div>
			<div class="no-move"></div>
		</div>
		<div class="box-content clearfix">
			<table id="ruleTable" class="table table-condensed table-striped table-bordered table-block table-hover rule-table">
				<thead>
					<tr>
						<th>状态</th>
						<th>名称</th>
						<th>描述</th>
					</tr>
				</thead>
				<tbody>
					<tr data-right-menu="#ruleDropMenu" data-id="rule01">
						<td><input type="checkbox" class="rule-state-check"></td>
						<td>rule01</td>
						<td>规则描述.........................................................</td>
					</tr>
					<tr data-right-menu="#ruleDropMenu" data-id="rule02">
						<td><input type="checkbox" class="rule-state-check"></td>
						<td>rule02</td>
						<td>规则描述.........................................................</td>
					</tr>
					<tr data-right-menu="#ruleDropMenu" data-id="rule03">
						<td><input type="checkbox" class="rule-state-check"></td>
						<td>rule03</td>
						<td>规则描述.........................................................</td>
					</tr>
					<tr data-right-menu="#ruleDropMenu" data-id="rule04">
						<td><input type="checkbox" class="rule-state-check"></td>
						<td>rule04</td>
						<td>规则描述.........................................................</td>
					</tr>
					<tr data-right-menu="#ruleDropMenu" data-id="rule05">
						<td><input type="checkbox" class="rule-state-check"></td>
						<td>rule05</td>
						<td>规则描述.........................................................</td>
					</tr>
					<tr data-right-menu="#ruleDropMenu" data-id="rule06">
						<td><input type="checkbox" class="rule-state-check"></td>
						<td>rule06</td>
						<td>规则描述.........................................................</td>
					</tr>
					<tr data-right-menu="#ruleDropMenu" data-id="rule07">
						<td><input type="checkbox" class="rule-state-check"></td>
						<td>rule07</td>
						<td>规则描述.........................................................</td>
					</tr>
					<tr data-right-menu="#ruleDropMenu" data-id="rule08">
						<td><input type="checkbox" class="rule-state-check"></td>
						<td>rule08</td>
						<td>规则描述.........................................................</td>
					</tr>
					<tr data-right-menu="#ruleDropMenu" data-id="rule09">
						<td><input type="checkbox" class="rule-state-check"></td>
						<td>rule09</td>
						<td>规则描述.........................................................</td>
					</tr>
					<tr data-right-menu="#ruleDropMenu" data-id="rule10">
						<td><input type="checkbox" class="rule-state-check"></td>
						<td>rule10</td>
						<td>规则描述.........................................................</td>
					</tr>
					<tr data-right-menu="#ruleDropMenu" data-id="rule11">
						<td><input type="checkbox" class="rule-state-check"></td>
						<td>rule11</td>
						<td>规则描述.........................................................</td>
					</tr>
					<tr data-right-menu="#ruleDropMenu" data-id="rule12">
						<td><input type="checkbox" class="rule-state-check"></td>
						<td>rule12</td>
						<td>规则描述.........................................................</td>
					</tr>
					<tr data-right-menu="#ruleDropMenu" data-id="rule13">
						<td><input type="checkbox" class="rule-state-check"></td>
						<td>rule13</td>
						<td>规则描述.........................................................</td>
					</tr>
					<tr data-right-menu="#ruleDropMenu" data-id="rule14">
						<td><input type="checkbox" class="rule-state-check"></td>
						<td>rule14</td>
						<td>规则描述.........................................................</td>
					</tr>
					<tr data-right-menu="#ruleDropMenu" data-id="rule15">
						<td><input type="checkbox" class="rule-state-check"></td>
						<td>rule15</td>
						<td>规则描述.........................................................</td>
					</tr>
					<tr data-right-menu="#ruleDropMenu" data-id="rule16">
						<td><input type="checkbox" class="rule-state-check"></td>
						<td>rule16</td>
						<td>规则描述.........................................................</td>
					</tr>

				</tbody>
			</table>
			
			<!-- /.col-sm-6 -->
		</div>
		<!-- /.box-content -->
	</div>
	<!-- /.box -->


</div>
<!-- /.col-xs-12 -->

<div class="dropdown right-click-menu" id="ruleDropMenu">
	<ul aria-labelledby="dropdownMenu" role="menu" class="dropdown-menu">
		<li id="add">
			<a href="#" onclick="addRule()" tabindex="-1"><span class="glyphicon glyphicon-plus"></span> 新建
			</a>
		</li>
		<li id="edit">
			<a href="#" onclick="modRule('{1}')" tabindex="-1"><span class="glyphicon glyphicon-edit"></span> 编辑
			</a>
		</li>
		<li id="copy">
			<a href="#" onclick="copyRule('{1}')" tabindex="-1"><span class="glyphicon glyphicon-share"></span> 复制
			</a>
		</li>
		<li id="del">
			<a href="#" tabindex="delRule('{1}')"><span class="glyphicon glyphicon-trash"></span> 删除
			</a>
		</li>
	</ul>
</div>
<div class="col-xs-12 hidden-xs" id="ruleInfo">

	<!-- Nav tabs -->
	<ul class="nav nav-tabs" role="tablist">
		<li class="active"><a href="#tab-zonglan" role="tab">概述</a></li>
	</ul>

	<!-- Tab panes -->
	<div class="tab-content clearfix">
		<div class="tab-pane active" id="tab-zonglan">
			<div class="col-xs-12">
				<div class="row">
					<div class="col-xs-12">
						<label class="control-label col-sm-2 col-md-1">名称:</label>
						<div class="col-xs-10 col-sm-10 col-md-11">Account Locked: Server_12/27/2013</div>
					</div>
				</div>
				<!-- /.row -->
				<div class="row">
					<div class="col-xs-6 col-md-3">
						<label class="control-label col-xs-5">状态:</label>
						<div class="pull-left">激活的</div>
					</div>
					<div class="col-xs-6 col-md-3">
						<label class="control-label col-xs-5">类型:</label>
						<div class="pull-left">高级</div>
					</div>
					<div class="col-xs-6 col-md-3">
						<label class="control-label col-xs-5 col-md-7">通知频率:</label>
						<div class="pull-left">1 day</div>
					</div>
					<div class="col-xs-6 col-md-3">
						<label class="control-label col-xs-5 col-md-7">告警种类:</label>
						<div class="pull-left">Server</div>
					</div>
				</div>
				<!-- /.row -->
				<div class="row">
					<div class="col-xs-12">
						<label class="control-label col-sm-2 col-md-1">描述:</label>
						<div class="col-xs-10 col-sm-10 col-md-11">Detects account lockout caused by excessive logon failures</div>
					</div>
					<div class="col-xs-12">
						<label class="control-label col-sm-2 col-md-1">条件:</label>
						<div class="col-xs-10 col-sm-10 col-md-11">
							<table>
								<tr>
									<td class="green-label">PATTERN</td>
									<td>
										<span class="purple-pattern">backdoorfound</span>
									</td>
								</tr>
								<tr>
									<td class="green-label">OCCURS</td>
									<td> in any 300 second time window</td>
								</tr>
							</table>
						</div>
					</div>
					<div class="col-xs-12">
						<label class="control-label col-sm-2 col-md-1">告警:</label>
						<div class="col-xs-10 col-sm-10 col-md-11">
							<table>
								<tr>
									<td class="green-label">GENERATE</td> 
									<td>Severity  9  <span class="level">(HIGH)</span>  Incident:  <strong>Backdoor_Attack_detected_by_NIPS</strong>   Display Name: <strong>Backdoor Attack detected by NIPS</strong></td>
								</tr>
								<tr>
									<td class="green-label">WITH</td>
									<td>源IP  =  <span class="purple-pattern">backdoorfound</span>.源IP, 目标IP  =  <span class="purple-pattern">backdoorfound</span>.目标IP</td>
								</tr>
							</table>
						</div>
					</div>
				</div>
				<!-- /.row -->

				<div class="row">
					<div class="col-xs-12">
						<label class="control-label col-xs-12">模式定义:</label>
						<div class="col-xs-12 pattern">
							<div><span class="purple-pattern"><i>backdoorfound</i></span></div>
							<table>
								<tr>
									<td class="green-label">If</td>
									<td>(源设备IP  <span class="pattern-keyword">IN</span>  Devices: Network IPS <strong>OR</strong> (源设备IP  <span class="pattern-keyword">IN</span>  Applications: Network IPS App <strong>AND</strong> 事件类型 <span class="pattern-keyword">CONTAINS</span> Snort-)) <strong>AND</strong> 事件类型 <span class="pattern-keyword">IN</span> EventTypes: Backdoor</td>
								</tr>
								<tr>
									<td class="green-label">WHERE</td>
									<td>源IP = <span class="purple-pattern">backdoorfound</span>.源IP, 目标IP  =  <span class="purple-pattern">backdoorfound</span>.目标IP</td>
								</tr>
								<tr>
									<td class="green-label">GROUP BY</td>
									<td>源IP, 目标IP</td>
								</tr>
							</table>
						</div>
						<!-- /.pattern -->
					</div>
					<div class="col-xs-12">
						<label class="control-label col-xs-12">触发事件属性:</label>
						<div class="col-xs-12">
							事件接收时间, 事件类型, 源IP, 目标IP, IP协议, 源TCP/UDP端口, 目标TCP/UDP端口, 源设备IP, 原始事件日志
						</div>
					</div>
				</div>
				<!-- /.row -->

			</div>

		</div>

	</div>
	<!-- /.col-xs-12 -->
</div>

<div class="overlay-frm hide" id="addRuleFrm">
	<div class="col-xs-12">
		<div class="box">
			<div class="box-header">
				<div class="pull-right">
					<a href="#" class="mr">保存</a><a href="#" class="btn-cancel mr">取消</a>
				</div>
				<div class="box-name">
					<span>添加新规则</span>
				</div>
				<div class="no-move"></div>
			</div>
			<!-- /.box-header -->
			<div class="box-content">
				<form action="#" class="form-horizontal">
					<div class="form-group">
						<label for="ruleName" class="control-label col-sm-3 col-lg-2">规则名称：</label>
						<div class="col-sm-8">
							<input type="text" class="form-control" id="ruleName" placeholder="输入规则名称">
						</div>
					</div>
					<!-- /.form-group -->
					<div class="form-group">
						<label for="ruleDesc" class="control-label col-sm-3 col-lg-2">描述：</label>
						<div class="col-sm-8">
							<textarea type="text" class="form-control" id="ruleDesc"></textarea>
						</div>
					</div>
					<!-- /.form-group -->
					<div class="form-group">
						<label class="control-label col-sm-3 col-lg-2">状态：</label>
						<div class="col-sm-8 checkbox">
							<div class="btn-group" data-toggle="buttons">
								<label class="btn btn-default"> <input
									name="vo.patientGender" type="radio" value="未激活" checked>未激活</label>
									<label class="btn btn-default"> <input name="vo.patientGender"
									type="radio" value="激活的">激活的 </label>
							</div>
						</div>
						<!-- /.btn-group -->
				
						</div>
					</div>
					<!-- /.form-group -->
				</form>
			</div>
			<!-- /.box-content -->
		</div>
		<!-- /.box -->
	</div>
	<!-- /.col-xs-12 -->
</div>
<!-- /#addRuleFrm -->

</div>
<!-- /.row -->



<!-- addRules -->
<!-- Modal -->
<div class="modal fade" id="addRuleModal" tabindex="-1" role="dialog" aria-labelledby="addRuleModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
				<h5 class="modal-title" id="addRuleModalLabel">运维工具</h5>
			</div>
			<div class="modal-body">

			</div>
		</div>
	</div>
</div>

<script type="text/javascript">
	$(document).ready(function() {
		LoadDataTablesScripts(tableReady);
		WinMove();
		tableContextMenu();
		ruleCheck(function(id, isChecked){
			alert(id + ': ' + isChecked);
		});

	});

	function tableReady() {
		dataTable('#ruleTable');
		/*以下函数是否需要在datatables重绘之后重新执行？*/
		tableTrClick('#ruleTable', function(ruleId){
			alert(ruleId+' clicked');
		});
	}

	/*新增规则*/
	function addRule() {
		showOverlayFrm('#addRuleFrm');
	}
	function modRule(id) {

	}
	function showOverlayFrm(handle) {
		var $handle = $(handle);
		$handle.removeClass('hide').show();
		$handle.find('.btn-cancel').click(function(event) {
			/* Act on the event */
			if (!window.confirm("确定要取消编辑吗？")) {return false;};
			$handle.find('form').each(function(index, el) {
				$(this)[0].reset();
			});
			$handle.hide();
		});
	}

</script>